INSERT INTO developments (
	job_number,
	job_type,
	job_description,
	occ_init,
	occ_prop,
	stories_init,
	stories_prop,
	zoningsft_init,
	zoningsft_prop,
	units_init,
	units_prop,
	status,
	status_date,
	status_a,
	status_d,
	status_p,
	status_r,
	status_x,
	ZoningDist1,
	ZoningDist2,
	ZoningDist3,
	SpecialDist1,
	SpecialDist2,
	Landmark,
	CityOwned,
	Owner_Type,
	Owner_NonProf,
	Owner_FirstNm,
	Owner_LastNm,
	Owner_BizNm,
	Owner_Address,
	Owner_ZipCode,
	Owner_Phone,
	Height_Init,
	Height_Prop,
	ConstructnSF,
	Enlrg_Horiz,
	Enlrg_Vert,
	EnlargementSF,
	CostEstimate,
	LoftBoardCert,
	eDesignation,
	CurbCut,
	TractHomes,
	address_house,
	address_street,
	bin,
	bbl,
	boro,
	x_withdrawal,
	latitude,
	longitude
	)
SELECT 
	jobnumber,
	jobtype,
	jobdescription,
	existingoccupancy,
	proposedoccupancy,
	existingnumstories,
	proposednumstories,
	existingzoningsqft,
	proposedzoningsqft,
	existingdwellingunits,
	proposeddwellingunits,
	jobstatusdesc,
	latestactiondate,
	prefilingdate,
	fullypaid,
	approved,
	fullypermitted,
	signoffdate,
	zoningdist1,
	zoningdist2,
	zoningdist3,
	specialdistrict1,
	specialdistrict2,
	landmarked,
	cityowned,
	ownertype,
	nonprofit,
	ownerfirstname,
	ownerlastname,
	ownerbusinessname,
	ownerhousestreetname,
	zip,
	ownerphone,
	existingheight,
	proposedheight,
	totalconstructionfloorarea,
	horizontalenlrgmt,
	verticalenlrgmt,
	enlargementsqfootage,
	initialcost,
	loftboard,
	littlee,
	curbcut,
	cluster,
	housenumber,
	streetname,
	bin,
	LEFT(bin, 1)||lpad(block, 5, '0')||lpad(RIGHT(lot,4), 4, '0'),
	borough,
	specialactionstatus,
	latitude,
	longitude	
FROM dob_jobapplications
WHERE jobdocnumber = '01' 
	AND (jobtype = 'A1' OR jobtype = 'DM' OR jobtype = 'NB');

-- formating bbl
UPDATE developments a
SET bbl = trim(trailing '0' FROM bbl::text)
WHERE length(bbl)>10;